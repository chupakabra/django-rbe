{% extends 'base.html' %}
{% load static %}
{% get_static_prefix as STATIC_PREFIX %}

{% block header %}
    <link rel="stylesheet" type="text/css" href='/static/css/new_profile.css'>

    <script src="{% static 'js/profile.js' %}"></script>
    <script src="{% static 'js/language.js' %}"></script>
{% endblock %}


{% block content %}
    <div class="container">
        <div class="row">
            <div class="col-xs-12 col-sm-8 col-sm-offset-2 col-md-6 col-md-offset-3">
                <ul id="accordion" class="accordion">
                    <li>
                        <div class="col col_4 iamgurdeep-pic" style="min-height:
                                {% if profile.avatar_link|length > 0 %}
                                    400px
                                {% else %}
                                    100px
                                {% endif %}">
                            <img id="user-picture" class="img-responsive iamgurdeeposahan"
                                 src="{{ profile.avatar_link }}">
                            <div class="edit-pic">
                                <!--<a href="https://twitter.com/gurdeeposahan1" target="_blank" class="fa fa-twitter"></a>
                                <a href="https://plus.google.com/u/0/105032594920038016998" target="_blank"
                                   class="fa fa-google"></a>-->
                            </div>
                            <div class="username">
                                <h2>{{ profile.user.username }}
                                    <small>
                                        <i class="fa fa-map-marker"></i>
                                        <span>
                                            {% if profile.user.location and profile.user.location.position_updated %}
                                                {{ profile.user.location.longitude_round }}
                                                {{ profile.user.location.latitude_round }}
                                                {{ profile.user.location.position_updated }}
                                            {% else %}
                                                Location not set!
                                            {% endif %}
                                        </span>
                                    </small>
                                </h2>
                                {% if profile.action_description %}
                                    <p><i class="fa fa-briefcase"></i>{{ profile.action_description }}</p>
                                {% endif %}
                                {% if my_profile %}
                                    <a id="user-picture-btn" class="btn-o">
                                        <i class="fa fa-camera"></i> Change Picture
                                    </a>
                                    <input style="display: none" id="choose_file" type="file" multiple
                                           name="file_source" size="0" value="Upload">
                                    <a id="location" class="btn-o">
                                        <i class="fa fa-map-marker"></i> Update Picture
                                    </a>
                                {% else %}
                                    <a href="{%  url 'compose' profile.user.id %}" class="btn-o">
                                        <i class="fa fa-envelope"></i> Send Message </a>
                                {% endif %}
                            </div>
                        </div>
                    </li>
                    <li>
                        <div class="link"><i class="fa fa-globe"></i>About<i class="fa fa-chevron-down"></i></div>
                        <ul class="submenu">
                            {% if my_profile %}
                                <div class="pull-right">
                                    <a style='padding-left: 12px' href="{% url 'change_profile' %}"><span
                                            class="fa fa-pencil"></span></a>
                                </div>
                            {% endif %}
                            {% include 'my_profile/my_about.html' %}
                        </ul>
                    </li>
                    <li>
                        <div class="link"><i class="fa fa-code"></i>Professional Skills<i
                                class="fa fa-chevron-down"></i></div>
                        <ul class="submenu">
                            {% if my_profile %}
                                <div class="pull-right">
                                    <a style='padding-left: 12px' href="{% url 'change_profile' %}"><span
                                            class="fa fa-pencil"></span></a>
                                </div>
                            {% endif %}
                            <li>
                                <a href="#">
                                    {% for element in user_skills %}
                                        <span data-phrase-id="{{ element.slug.id }}"
                                              class="tags">{{ element.slug.value }} <span
                                                class="badge">{{ element.level }}</span></span>
                                    {% endfor %}
                                </a>
                            </li>
                        </ul>
                    </li>
                    <li>
                        <div class="link"><i class="fa fa-picture-o"></i>Languages
                            <small>(language count)</small>
                            <i class="fa fa-chevron-down"></i></div>
                        <ul class="submenu">
                            {% include 'user/prf_languages.html' %}
                        </ul>
                    </li>
                    <li>
                        <div class="link"><i class="fa fa-users"></i>Close People
                        <small></small>
                        <i class="fa fa-chevron-down"></i></div>
                        <ul class="submenu">
                            {% include 'my_profile/distance_table.html' %}
                        </ul>
                    </li>
                </ul>
            </div>
        </div>
    </div>
    <script>
        $(function () {
            var Accordion = function (el, multiple) {
                this.el = el || {};
                this.multiple = multiple || false;

                // Variables privadas
                var links = this.el.find('.link');
                // Evento
                links.on('click', {el: this.el, multiple: this.multiple}, this.dropdown)
            }

            Accordion.prototype.dropdown = function (e) {
                var $el = e.data.el;
                $this = $(this),
                        $next = $this.next();

                $next.slideToggle();
                $this.parent().toggleClass('open');

                if (!e.data.multiple) {
                    $el.find('.submenu').not($next).slideUp().parent().removeClass('open');
                }
                ;
            }

            var accordion = new Accordion($('#accordion'), false);
        });
    </script>

    <script>
        $(document).ready(function(){
            $('.profile-link').click(function () {
                window.location.href = $(this).data('href');
            });
        });


        $("#user-picture-btn").click(function (e) {
            e.preventDefault();
            $('#choose_file').click();
        });

                    $("#choose_file").bind('change', function (event) {
                    upload_profile_image(event)
                    });
                    </script>
{% endblock %}